# Run as a less privileged user for security reasons.
user nginx;

# #worker_threads to run;
# "auto" sets it to the #CPU_cores available in the system, and
# offers the best performance.
worker_processes    auto;

events { worker_connections 1024; }

http {

#    upstream php-upstream {
#        server webinterface:80;
#    }

    server {
       listen 80;
       listen [::]:80;
#
#        index index.php index.html index.htm;
#
#        location / {
#            try_files $uri $uri/ /index.php$is_args$args;
#        }
#
#        location ~ \.php$ {
#            try_files $uri /index.php =404;
#            fastcgi_pass php-upstream;
#            fastcgi_index index.php;
#            fastcgi_buffers 16 16k;
#            fastcgi_buffer_size 32k;
#            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
#            fastcgi_read_timeout 600;
#            include fastcgi_params;
#        }
#
#       location ~ /\.ht {
#           deny all;
#       }

        location /signin-discord {
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header Host "127.0.0.1:5565";
            proxy_pass http://backend:80;
        }

        location /api {
            client_max_body_size 10m;
            
            proxy_set_header X-Forwarded-Proto $scheme;
            proxy_set_header Host "127.0.0.1:5565";
            proxy_pass http://backend:80;
        }
    }
}